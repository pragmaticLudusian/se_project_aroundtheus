!function(){"use strict";class e{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._selector=t}renderItems(){this._container=document.querySelector(this._selector),this._items.forEach((e=>{this._renderer(e)}))}addItem(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"append";this._container[t](e)}}class t{constructor(e,t,s,r,i){let{name:n,link:a,_id:o,isLiked:c}=e;this._name=n,this._link=a,this._id=o,this._isLiked=c,this._cardSelector=t,this._handleImageClick=s,this._handleCardDelete=r,this._handleCardLike=i}_setEventListeners(){this._cardImage.addEventListener("click",(()=>{this._handleImageClick(this.getInfo())})),this._cardLike.addEventListener("click",(()=>{this._handleCardLike(this)})),this._cardDelete.addEventListener("click",(()=>{this._handleCardDelete(this)}))}likeCard(e){this._isLiked=e;const t=this._isLiked?"add":"remove";this._cardLike.classList[t]("card__like_active")}deleteCard(){this._cardDelete.closest(".card").remove(),this._cardElement=null}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}generateCard(){return this._cardElement=this._getTemplate(),this._cardImage=this._cardElement.querySelector(".card__image"),this._cardImage.src=this._link,this._cardImage.alt=this._name,this._cardElement.querySelector(".card__title").textContent=this._name,this._cardLike=this._cardElement.querySelector(".card__like"),this.likeCard(this._isLiked),this._cardDelete=this._cardElement.querySelector(".card__delete-button"),this._setEventListeners(),this._cardElement}getInfo(){return{name:this._name,link:this._link,id:this._id,isLiked:this._isLiked}}}class s{constructor(e,t){this._config=e,this._form=t}_setEventListeners(){this._inputList=Array.from(this._form.querySelectorAll(this._config.inputSelector)),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(this,e)}))})),this._buttonElement=this._form.querySelector(this._config.submitButtonSelector)}_checkInputValidity(e,t){this._hasInvalidInput(this._inputList)?(this._showInputError(this,t),this.disableButton()):(this._hideInputError(this,t),this.enableButton())}_hasInvalidInput(e){return e.some((e=>!e.validity.valid))}_showInputError(e,t){const s=this._form.querySelector(`#${t.id}_error`);s.textContent=t.validationMessage,s.classList.add(this._config.activeErrorClass)}_hideInputError(e,t){const s=this._form.querySelector(`#${t.id}_error`);s.classList.remove(this._config.activeErrorClass),s.textContent=""}disableButton(){this._buttonElement.classList.replace(this._config.activeButtonClass,this._config.inactiveButtonClass),this._buttonElement.setAttribute("disabled",!0)}enableButton(){this._buttonElement.removeAttribute("disabled"),this._buttonElement.classList.replace(this._config.inactiveButtonClass,this._config.activeButtonClass)}resetFormValidation(){this._inputList.forEach((e=>{this._hideInputError(this,e)})),this.disableButton()}enableValidation(){this._setEventListeners()}}class r{constructor(e){this._popup=e}setEventListeners(){this._popup.addEventListener("click",(e=>{this._popup===e.target&&this.close()})),this._popup.querySelector(".modal__close-button").addEventListener("click",(()=>this.close()))}open(){this._escCallback=this._handleEscClose.bind(this),document.addEventListener("keydown",this._escCallback),this._popup.classList.add("modal_opened")}close(){this._popup.classList.remove("modal_opened"),document.removeEventListener("keydown",this._escCallback)}_handleEscClose(e){"Escape"===e.key&&this.close()}}class i extends r{constructor(e,t,s,r,i){super(e),this._handleSubmit=t,this._inputSelector=s,this._submitSelector=r,this._submitText=i,this._submitOriginal=this._submitSelector.textContent}setEventListeners(){super.setEventListeners(),this._popup.addEventListener("submit",(e=>{this._handleSubmit(e,this._getInputValues())})),this._inputFields=Array.from(this._popup.querySelectorAll(this._inputSelector))}_getInputValues(){const e={};return this._inputFields.forEach((t=>{e[t.name]=t.value})),e}setRender(e){this._submitSelector.textContent=e?this._submitText:this._submitOriginal}}const n={inputSelector:".form__input",submitButtonSelector:".form__save-button",inactiveButtonClass:"form__save-button_inactive",activeButtonClass:"form__save-button_active",activeErrorClass:"form__error_active"},a=document.querySelector(".profile"),o=a.querySelector(".profile__edit-button"),c=a.querySelector(".profile__name"),l=a.querySelector(".profile__description"),d=a.querySelector(".profile__avatar"),h=a.querySelector(".profile__avatar-edit"),_=document.querySelector("#modal_profile_info"),u=document.forms.profile_info_form,m=u.name,p=u.description,f=u.profile_info_form_save,v=document.querySelector("#modal_profile_avatar"),E=document.forms.profile_avatar_form,b=E.avatar,g=E.profile_avatar_form_save,k=a.querySelector(".profile__add-button"),L=document.querySelector("#modal_card-add"),C=document.forms["card-add_form"],S=C["card-add_form_save"],y=document.querySelector("#modal_card-view"),I=y.querySelector(".modal__image"),j=y.querySelector(".modal__caption"),w=document.querySelector("#modal_card-delete"),P=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}getUserProfileData(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`error ${e.status} while getting user data`))).catch((e=>Promise.reject(e)))}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`error ${e.status} while getting cards data`))).catch((e=>Promise.reject(e)))}getUserAndCards(e){return Promise.all(e).catch((e=>Promise.reject("Something went wrong :(",e)))}setUserProfileData(e,t){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then((e=>e.ok?e.json():Promise.reject(`error ${e.status} while updating user data`))).catch((e=>Promise.reject(e)))}addNewCard(e,t){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then((e=>e.ok?e.json():Promise.reject(`error ${e.status} while adding a new card`))).catch((e=>Promise.reject(e)))}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`error ${e.status} while deleting a card`))).catch((e=>Promise.reject(e)))}likeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`error ${e.status} while liking a card`))).catch((e=>Promise.reject(e)))}unlikeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`error ${e.status} while unliking a card`))).catch((e=>Promise.reject(e)))}setUserProfileAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then((e=>e.ok?e.json():Promise.reject(`error ${e.status} while updating an avatar`))).catch((e=>Promise.reject(e)))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{"content-type":"application/json",authorization:"c48564f3-ecfb-4a65-b35d-031aabc842ce"}});let q,U;P.getUserAndCards([P.getUserProfileData().then((e=>{let{_id:t,name:s,about:r,avatar:i}=e;U=t,x.setUserInfo(s,r),x.setAvatar(i)})).catch((e=>{console.error(e)})),P.getInitialCards().then((t=>{q=new e({items:t,renderer:e=>{const t=$(e);q.addItem(t)}},".gallery__cards"),q.renderItems()})).catch((e=>{console.error(e)}))]).catch((e=>{console.error(e)}));const $=e=>new t(e,"#card-template",V,O,N).generateCard(),A={};Array.from(document.forms).forEach((e=>{const t=new s(n,e);A[e.id]=t,t.enableValidation()}));const x=new class{constructor(e){let{name:t,description:s,avatar:r}=e;this._nameElement=t,this._jobElement=s,this._avatarElement=r}getUserInfo(){return{name:this._nameElement.textContent,description:this._jobElement.textContent}}setUserInfo(e,t){this._nameElement.textContent=e,this._jobElement.textContent=t}getAvatar(){return this._avatarElement.src}setAvatar(e){this._avatarElement.src=e}}({name:c,description:l,avatar:d});o.addEventListener("click",(()=>{const{name:e,description:t}=x.getUserInfo();m.value=e,p.value=t,A.profile_info_form.resetFormValidation(),D.open()}));const D=new i(_,((e,t)=>{let{name:s,description:r}=t;e.preventDefault(),D.setRender(!0),P.setUserProfileData(s,r).then((()=>{x.setUserInfo(s,r)})).catch((e=>{console.error(e)})).finally((()=>{D.close(),D.setRender(!1)}))}),n.inputSelector,f,"Saving...");D.setEventListeners(),h.addEventListener("click",(()=>{b.value=d.src,B.open()}));const B=new i(v,((e,t)=>{let{avatar:s}=t;e.preventDefault(),B.setRender(!0),P.setUserProfileAvatar(s).then((()=>{d.src=s})).catch((e=>{console.error(e)})).finally((()=>{B.close(),B.setRender(!1)}))}),n.inputSelector,g,"Saving...");B.setEventListeners(),k.addEventListener("click",(()=>{T.open()}));const T=new i(L,((e,t)=>{let{title:s,link:r}=t;e.preventDefault(),T.setRender(!0),P.addNewCard(s,r).then((e=>{const t=$(e);q.addItem(t,"prepend")})).catch((e=>{console.error(e)})).finally((()=>{T.close(),T.setRender(!1),C.reset(),A["card-add_form"].disableButton()}))}),n.inputSelector,S,"Creating...");function V(e){R.open(e)}T.setEventListeners();const R=new class extends r{constructor(e,t){super(e),this._modalElements=t}open(e){let{name:t,link:s}=e;this._modalElements.image.src=s,this._modalElements.image.alt=t,this._modalElements.caption.textContent=t,super.open()}}(y,{image:I,caption:j});function N(e){const t=e.getInfo().isLiked?"unlikeCard":"likeCard";P[t](e.getInfo().id).then((t=>{e.likeCard(t.isLiked)})).catch((e=>{console.error(e)}))}function O(e){F.open(e)}R.setEventListeners();const F=new class extends r{constructor(e,t){super(e),this._handleSubmit=t}setEventListeners(){super.setEventListeners(),this._popup.addEventListener("submit",(e=>{this._handleSubmit(e,this._initiator)}))}open(e){this._initiator=e,super.open()}}(w,((e,t)=>{e.preventDefault(),P.deleteCard(t.getInfo().id).then((()=>{t.deleteCard()})).catch((e=>{console.error(e)})).finally((()=>{F.close()}))}));F.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0h4TixLQUFLdU4sV0FBYUMsRUFDbEJwSCxNQUFNWCxNQUNSLEdKMk5Bb0QsR0FDQSxDQUFDdkQsRUFBT3dILEtBRU54SCxFQUFNZ0gsaUJBRU54RCxFQUNHdEcsV0FBV3NLLEVBQUszSyxVQUFVZ0IsSUFDMUJtRyxNQUFLLEtBQ0p3RCxFQUFLdEssWUFBWSxJQUVsQnFILE9BQU9DLElBQ05zQixRQUFRQyxNQUFNdkIsRUFBSSxJQUVuQnlDLFNBQVEsS0FDUGUsRUFBZ0I5SCxPQUFPLEdBQ3ZCLElBR1I4SCxFQUFnQmpJLG1CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICAvLyBub24tdGFuZ2libGUgY2xhc3MgdG8gYWRkIGVsZW1lbnRzIHRvIHRoZSB3ZWJwYWdlXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIHNlbGVjdG9yKSB7XG4gICAgdGhpcy5faXRlbXMgPSBpdGVtczsgLy8gYXJyYXkgb2Ygb2JqZWN0c1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7IC8vIGN1c3RvbS10YWlsb3JlZCBmdW5jIGZvciBjbGFzc2VzXG4gICAgdGhpcy5fc2VsZWN0b3IgPSBzZWxlY3RvcjsgLy8gY2xhc3MvaWQgc2VsZWN0b3IgKHR5cGVvZiBzdHJpbmcpXG4gIH1cblxuICByZW5kZXJJdGVtcygpIHtcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX3NlbGVjdG9yKTtcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTsgLy8gcGFzcyBpdGVtIG91dCBvZiBhcnJheSBhcyBhcmcgdG8gdGhlIGZ1bmN0aW9uIGJvZHkgaW5zaWRlIGluZGV4LmpzXG4gICAgfSk7XG4gIH1cblxuICBhZGRJdGVtKGVsZW1lbnQsIG1ldGhvZCA9IFwiYXBwZW5kXCIpIHtcbiAgICB0aGlzLl9jb250YWluZXJbbWV0aG9kXShlbGVtZW50KTsgLy8gYWRkIGVsZW0gdG8gc2VsZWN0ZWQgY29udGFpbmVyXG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihcbiAgICB7IG5hbWUsIGxpbmssIF9pZCwgaXNMaWtlZCB9LCAvLyByZWZsZWN0IGZyb20gSlNPTlxuICAgIGNhcmRTZWxlY3RvcixcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxuICAgIGhhbmRsZUNhcmREZWxldGUsXG4gICAgaGFuZGxlQ2FyZExpa2VcbiAgKSB7XG4gICAgdGhpcy5fbmFtZSA9IG5hbWU7XG4gICAgdGhpcy5fbGluayA9IGxpbms7XG4gICAgdGhpcy5faWQgPSBfaWQ7XG4gICAgdGhpcy5faXNMaWtlZCA9IGlzTGlrZWQ7XG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yOyAvLyB0ZW1wbGF0ZVxuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrOyAvLyBoYW5kbGVDYXJkUG9wdXBJbWFnZSgpOyBhbGwgdGhlc2UgYXJlIGN1cnJlbnRseSBAaW5kZXguanNcbiAgICB0aGlzLl9oYW5kbGVDYXJkRGVsZXRlID0gaGFuZGxlQ2FyZERlbGV0ZTsgLy8gaGFuZGxlQ2FyZFBvcHVwRGVsZXRlKCk7IGNvbmZpcm1hdGlvbiBwb3B1cCB0byBkZWxldGUgYSBjYXJkXG4gICAgdGhpcy5faGFuZGxlQ2FyZExpa2UgPSBoYW5kbGVDYXJkTGlrZTsgLy8gaGFuZGxlQ2FyZExpa2UoKTsgdXNlZCB0byBoYW5kbGUgdGhlIERPTSBzaWRlIG9mIHRoZSBsaWtlIGJvb2xlYW4gc3RhdHVzIGZyb20gdGhlIHNlcnZlclxuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2NhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh0aGlzLmdldEluZm8oKSk7IC8vIHVzZSBqdXN0IG5hbWUgYW5kIGxpbmsgdG8gbG9hZCB0aGUgcG9wdXAgaW1hZ2VcbiAgICB9KTtcblxuICAgIHRoaXMuX2NhcmRMaWtlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVDYXJkTGlrZSh0aGlzKTsgLy8gaWYgY2FsbGJhY2sgd2FzIGp1c3QgYSByZWYgdG8gdGhlIG1ldGhvZCwgaXQgd291bGQgcGFzcyBhcyB0aGUgY2FyZCBpbWFnZSBlbGVtZW50LCBzbyBpbnN0ZWFkIHRoaXMgd291bGQgcGFzcyBhbG9uZyB0aGUgY2xhc3Mgb2JqZWN0IHdpdGggYWxsIHRoZSBjbGFzcy1zcGVjaWZpYyB2YXJzXG4gICAgfSk7XG5cbiAgICB0aGlzLl9jYXJkRGVsZXRlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVDYXJkRGVsZXRlKHRoaXMpOyAvLyBzYW1lIGhlcmUsIGJ1dCBoZXJlIHRoZSBlbGVtZW50J3MgZ29pbmcgdG8gYmUgbmVlZGVkIHRvIGRlbGV0ZSB0aGUgY2FyZCBmcm9tIERPTSBqdXN0IGFmdGVyIHJlcXVlc3RpbmcgdGhlIGFwaSB0byBkZWxldGUgZnJvbSB0aGUgc2VydmVyXG4gICAgfSk7XG4gIH1cblxuICBsaWtlQ2FyZChpc0xpa2VkKSB7XG4gICAgdGhpcy5faXNMaWtlZCA9IGlzTGlrZWQ7XG4gICAgY29uc3QgbWV0aG9kID0gdGhpcy5faXNMaWtlZCA/IFwiYWRkXCIgOiBcInJlbW92ZVwiO1xuICAgIHRoaXMuX2NhcmRMaWtlLmNsYXNzTGlzdFttZXRob2RdKFwiY2FyZF9fbGlrZV9hY3RpdmVcIik7XG4gICAgLy8gY29uc29sZS5sb2codGhpcy5nZXRJbmZvKCksIHRoaXMuX2lzTGlrZWQpO1xuICB9XG5cbiAgZGVsZXRlQ2FyZCgpIHtcbiAgICAvLyB3b3JrcyB3aXRoIHRoZSBzYW1lIHByaW5jaXBsZSBvZiBnZW5lcmF0ZUNhcmQoKSwgYnV0IGFsc28gcG9zc2libGUgZnJvbSBpbmRleC5qc1xuICAgIHRoaXMuX2NhcmREZWxldGUuY2xvc2VzdChcIi5jYXJkXCIpLnJlbW92ZSgpO1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gbnVsbDsgLy8gZnJlZSB1cCByZXNvdXJjZXNcbiAgfVxuXG4gIF9nZXRUZW1wbGF0ZSgpIHtcbiAgICBjb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXG4gICAgICAuY2xvbmVOb2RlKHRydWUpOyAvLyBwcmUtbG9vcCBmb3IgY2FyZEdlbmVyYXRlKClcbiAgICByZXR1cm4gY2FyZFRlbXBsYXRlO1xuICB9XG5cbiAgZ2VuZXJhdGVDYXJkKCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTsgLy8gdHJlYXQgbGlrZSBjbGFzcy1zcGVjaWZpYyB2YXIgKG5vbi1zdGF0aWMsIGtpbmRhIGxpa2UgbGV0KVxuICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7IC8vIHRoaXMuX3ZhciB3b3VsZCBiZSB1c2VkIGZvciBoYW5kbGluZyBpbWFnZSBjbGljaywgc28gaXQncyBub3QgYSBjb25zdCBoZXJlXG4gICAgdGhpcy5fY2FyZEltYWdlLnNyYyA9IHRoaXMuX2xpbms7IC8vIGZvcm1hbGx5IHJlZmVycmVkIHRvIGFzIFwiY2xhc3MgZmllbGRzXCIgb3IgcHJvcGVydGllc1xuICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIikudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMuX2NhcmRMaWtlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlXCIpO1xuICAgIHRoaXMubGlrZUNhcmQodGhpcy5faXNMaWtlZCk7XG4gICAgdGhpcy5fY2FyZERlbGV0ZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuXG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xuICB9XG5cbiAgZ2V0SW5mbygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogdGhpcy5fbmFtZSwgLy8gZXZlbiBpZiB0aGUgZm9ybSB0byBhZGQgYSBjYXJkIGlzIGNhbGxlZCBcInRpdGxlXCIsIGl0IGNhbiBiZSBhbGlhc2VkIGJ5IHJlZiBvciBieSBkZWNvbnN0cnVjdG9yc1xuICAgICAgbGluazogdGhpcy5fbGluayxcbiAgICAgIGlkOiB0aGlzLl9pZCxcbiAgICAgIGlzTGlrZWQ6IHRoaXMuX2lzTGlrZWQsXG4gICAgfTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKGNvbmZpZywgZm9ybSkge1xuICAgIHRoaXMuX2NvbmZpZyA9IGNvbmZpZzsgLy8gc2V0dGluZ3Mgb2JqXG4gICAgdGhpcy5fZm9ybSA9IGZvcm07IC8vIGZvcm0gZWxlbSwgbm90IGlkXG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcbiAgICAgIHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9jb25maWdbXCJpbnB1dFNlbGVjdG9yXCJdKVxuICAgICk7XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgLy8gdGhpcy5faW5wdXRFbGVtZW50ID0gaW5wdXRFbGVtZW50OyAvLyB0aGlzIGdldHMgb3ZlcndyaXR0ZW4gYW5kIGNhdXNlcyB0aGUgbGFzdCBpbnB1dCBvbiB0aGUgbGlzdCB0byBiZSBzZWxlY3RlZC4gaXQgbWF5IG5vdCBiZSBzdGF0aWMsIGJ1dCBpdCdzIHNoYXJlZCBhbW9uZyB0aGUgdmVyeSBzYW1lIGluc3RhbmNlIG9mIHRoZSBjbGFzc1xuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eSh0aGlzLCBpbnB1dEVsZW1lbnQpOyAvLyBhcyBzdWNoLCBhbm90aGVyIGFyZ3VtZW50IG5lZWRzIHRvIHBhc3MgdGhyb3VnaFxuICAgICAgfSk7XG4gICAgfSk7XG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcbiAgICAgIHRoaXMuX2NvbmZpZ1tcInN1Ym1pdEJ1dHRvblNlbGVjdG9yXCJdXG4gICAgKTsgLy8gZm9yIHVzZSBpbiBib3RoIHRoZSBjbGFzcyBjb25zdHJ1Y3Rpb24gYW5kIHJlc2V0VmFsaWRhdGlvbiBtZXRob2QsIGhlcmUgYmVpbmcgdGhlIGV4Y2VwdGlvbiByYXRoZXIgdGhhbiB0aGUgcnVsZVxuICB9XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShvYmosIGlucHV0RWxlbWVudCkge1xuICAgIC8vIG9iaiwgYmVpbmcgdGhlIDFzdCBwYXJhbWV0ZXIgaXMgZXF1aXZhbGVudCB0byB0aGUga2V5d29yZCB0aGlzXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCh0aGlzLl9pbnB1dExpc3QpKSB7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcih0aGlzLCBpbnB1dEVsZW1lbnQpO1xuICAgICAgdGhpcy5kaXNhYmxlQnV0dG9uKCk7IC8vIFwiZW5kLXBvaW50XCIgbWV0aG9kcyBuZWVkIG5vIGFyZ3MgaW5jbC4gdGhpc1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcih0aGlzLCBpbnB1dEVsZW1lbnQpO1xuICAgICAgdGhpcy5lbmFibGVCdXR0b24oKTtcbiAgICB9XG4gIH1cblxuICBfaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkge1xuICAgIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcbiAgICB9KTtcbiAgfVxuXG4gIF9zaG93SW5wdXRFcnJvcihvYmosIGlucHV0RWxlbWVudCkge1xuICAgIGNvbnN0IGlucHV0RXJyb3IgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWxlbWVudC5pZH1fZXJyb3JgKTtcbiAgICBpbnB1dEVycm9yLnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xuICAgIGlucHV0RXJyb3IuY2xhc3NMaXN0LmFkZCh0aGlzLl9jb25maWdbXCJhY3RpdmVFcnJvckNsYXNzXCJdKTtcbiAgfVxuXG4gIF9oaWRlSW5wdXRFcnJvcihvYmosIGlucHV0RWxlbWVudCkge1xuICAgIGNvbnN0IGlucHV0RXJyb3IgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWxlbWVudC5pZH1fZXJyb3JgKTtcbiAgICBpbnB1dEVycm9yLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fY29uZmlnW1wiYWN0aXZlRXJyb3JDbGFzc1wiXSk7XG4gICAgaW5wdXRFcnJvci50ZXh0Q29udGVudCA9IFwiXCI7XG4gIH1cblxuICBkaXNhYmxlQnV0dG9uKCkge1xuICAgIC8vIHVubGVzcyB1c2luZyB0aGUgcHJpdmF0ZSBwcm9wZXJ0aWVzIGZyb20gdGhlIGNvbnN0cnVjdG9yLCB1c2luZyBpbnRlcm1lZGlhdGUgcHJpdi4gcHJvcHMuIHdvdWxkIGJlIGNvbnNpZGVyZWQgdW5kZWYgaWYgY2FsbGVkIGZyb20gb3V0c2lkZSB1c2luZyBhIHB1YmxpYyBtZXRob2RcbiAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZXBsYWNlKFxuICAgICAgdGhpcy5fY29uZmlnW1wiYWN0aXZlQnV0dG9uQ2xhc3NcIl0sXG4gICAgICB0aGlzLl9jb25maWdbXCJpbmFjdGl2ZUJ1dHRvbkNsYXNzXCJdXG4gICAgKTtcbiAgICB0aGlzLl9idXR0b25FbGVtZW50LnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIHRydWUpO1xuICB9XG5cbiAgZW5hYmxlQnV0dG9uKCkge1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKFwiZGlzYWJsZWRcIik7XG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVwbGFjZShcbiAgICAgIHRoaXMuX2NvbmZpZ1tcImluYWN0aXZlQnV0dG9uQ2xhc3NcIl0sXG4gICAgICB0aGlzLl9jb25maWdbXCJhY3RpdmVCdXR0b25DbGFzc1wiXVxuICAgICk7XG4gIH1cblxuICByZXNldEZvcm1WYWxpZGF0aW9uKCkge1xuICAgIC8vIHJlbW92ZSBlcnJvcnMgYW5kIGRpc2FibGUgdGhlbSByYXRoZXIgdGhhbiBhZGRpbmcgdGhlbSBhbmV3XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IodGhpcywgaW5wdXRFbGVtZW50KTtcbiAgICB9KTtcbiAgICB0aGlzLmRpc2FibGVCdXR0b24oKTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cCkge1xuICAgIHRoaXMuX3BvcHVwID0gcG9wdXA7IC8vIHRoZSBwb3B1cCBzZWxlY3RvciAoYXMgYW4gZWxlbWVudClcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+IHtcbiAgICAgIGlmICh0aGlzLl9wb3B1cCA9PT0gZXZlbnQudGFyZ2V0KSB0aGlzLmNsb3NlKCk7XG4gICAgfSk7XG4gICAgY29uc3QgY2xvc2VCdXR0b24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idXR0b25cIik7XG4gICAgY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuY2xvc2UoKSk7XG4gICAgLy8gZm9yIGNhbGxiYWNrIGZ1bmMgdG8gY2FsbCBmb3J3YXJkIGEgZnVuYywgaXQgd291bGQgc3RpbGwgbmVlZCB0byBoYXZlIGFuIGFub24uZnVuYyBib2R5LCBzaW5jZSBcInRoaXNcIiBiZWluZyB0aGUgY2xhc3Mgb2JqZWN0IGZ1bmN0aW9ucyBiZXR0ZXIgaW5zaWRlIGFub24uZnVuYyBhcyBvcHBvc2VkIHRvIGEgbmFtZWQgY2FsbGJhY2tcbiAgfVxuXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5fZXNjQ2FsbGJhY2sgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpOyAvLyBhcHBhcmVudGx5IHdpdGggbmFtZWQgY2FsbGJhY2tzIC0gd2hpY2ggYXJlIHJlcXVpcmVkIHRvIGJlIHJlbW92ZWQgLSBcInRoaXNcIiBpbiBfaEVDIHdpbGwgcmVmZXIgdG8gdGhlIHdob2xlIGRvY3VtZW50IGFuZCBub3QgdGhlIHBvcHVwIGluc3RhbmNlLCBzbyBiaW5kaW5nIGl0IGVuc3VyZXMgdGhhdCB0aGUgcG9wdXAgaXRzZWxmIGNhbiBiZSBwYXNzZWQgdGhyb3VnaCB3aXRob3V0IGFkZGl0aW9uYWwgYXJncyBhbmQgcmV0YWluIGV2ZW50LmtleS4uLlxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2VzY0NhbGxiYWNrKTsgLy8gLi4uaG93ZXZlciwgdXNpbmcgYmluZCgpIGNhdXNlcyBhbiBlbnRpcmVseSBkaWZmZXJlbnQgZnVuY3Rpb24gd2l0aCBhIGRpZmZlcmVudCByZWYgdG8gYmUgY3JlYXRlZCwgc28gdGhlIG9yaWdpbmFsIHJlZiB3b3VsZCBiZSBsb3N0LCBpZiBub3QgdG8gaGF2ZSBpdCBzYXZlZCBpbnRvIGEgY2xhc3MgZmllbGQgdG8gcmVtb3ZlIHRoZSBldmVudCBsaXN0ZW5lci5cbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9lc2NDYWxsYmFjayk7IC8vIFFvTCBhbmQgaXQgY2FuIGJlIHJlLWVuYWJsZWQgdXBvbiBvcGVuaW5nIHRoZSBwb3B1cFxuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlKGV2ZW50KSB7XG4gICAgaWYgKGV2ZW50LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwLCBoYW5kbGVTdWJtaXQsIGlucHV0U2VsZWN0b3IsIHN1Ym1pdFNlbGVjdG9yLCBzdWJtaXRUZXh0KSB7XG4gICAgc3VwZXIocG9wdXApOyAvLyBwb3B1cCBzZWxlY3RlZCBlbGVtZW50XG4gICAgdGhpcy5faGFuZGxlU3VibWl0ID0gaGFuZGxlU3VibWl0OyAvLyBjYWxsYmFjayBmdW5jIGZvciBzdWJtaXR0aW5nIGZvcm1cbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gaW5wdXRTZWxlY3RvcjtcbiAgICB0aGlzLl9zdWJtaXRTZWxlY3RvciA9IHN1Ym1pdFNlbGVjdG9yOyAvLyB1c2VkIGZvciBhcGkgcmVuZGVyXG4gICAgdGhpcy5fc3VibWl0VGV4dCA9IHN1Ym1pdFRleHQ7IC8vIHJlbmRlciB0ZXh0IHdoaWxlIGNvbnRhY3RpbmcgYXBpXG4gICAgdGhpcy5fc3VibWl0T3JpZ2luYWwgPSB0aGlzLl9zdWJtaXRTZWxlY3Rvci50ZXh0Q29udGVudDtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZlbnQpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdChldmVudCwgdGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7IC8vIHBhc3MgYW5kIGV4ZWN1dGUgZnVuY1xuICAgIH0pO1xuICAgIHRoaXMuX2lucHV0RmllbGRzID0gQXJyYXkuZnJvbShcbiAgICAgIHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcilcbiAgICApO1xuICB9XG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XG4gICAgdGhpcy5faW5wdXRGaWVsZHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIGlucHV0VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIGlucHV0VmFsdWVzO1xuICB9XG5cbiAgc2V0UmVuZGVyKHN0YXRlKSB7XG4gICAgdGhpcy5fc3VibWl0U2VsZWN0b3IudGV4dENvbnRlbnQgPSBzdGF0ZVxuICAgICAgPyB0aGlzLl9zdWJtaXRUZXh0XG4gICAgICA6IHRoaXMuX3N1Ym1pdE9yaWdpbmFsO1xuICB9XG59XG4iLCJleHBvcnQgY29uc3QgY29uZmlndXJhdGlvbiA9IHtcbiAgLy8gZm9ybVNlbGVjdG9yOiBcIi5mb3JtXCIsIC8vIGhhbmRsZWQgdGhyb3VnaCBkb2N1bWVudC5mb3JtcyBwc2V1ZG8tYXJyYXlcbiAgaW5wdXRTZWxlY3RvcjogXCIuZm9ybV9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLmZvcm1fX3NhdmUtYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwiZm9ybV9fc2F2ZS1idXR0b25faW5hY3RpdmVcIixcbiAgYWN0aXZlQnV0dG9uQ2xhc3M6IFwiZm9ybV9fc2F2ZS1idXR0b25fYWN0aXZlXCIsXG4gIC8vIGlucHV0RXJyb3JDbGFzczogXCJwb3B1cF9faW5wdXRfdHlwZV9lcnJvclwiLCAvLyBoYW5kbGVkIHZpYSBDU1MgcHNldWRvLWNsYXNzXG4gIC8vIGVycm9yU2VsZWN0b3I6IGAjJHtpbnB1dEVsZW1lbnQuaWR9X2Vycm9yYCwgLy8gZHVlIHRvIHVzZSBvZiBlc2MuIGxpdC4gYW5kIGlkIGNsYXNzIHRlbXBsYXRlcywgdGhpcyBpcyB1bnVzZWRcbiAgYWN0aXZlRXJyb3JDbGFzczogXCJmb3JtX19lcnJvcl9hY3RpdmVcIixcbn07XG5cbi8vIGluaXQgcHJvZmlsZSBlZGl0aW5nICYgcmVsYXRlZCBtb2RhbCB3aW5kb3dcbmNvbnN0IHByb2ZpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVcIik7XG5leHBvcnQgY29uc3QgYnV0dG9uRWRpdFByb2ZpbGUgPSBwcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZU5hbWUgPSBwcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmFtZVwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRGVzY3JpcHRpb24gPSBwcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCJcbik7XG5leHBvcnQgY29uc3QgcHJvZmlsZUF2YXRhciA9IHByb2ZpbGUucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXJcIik7XG5leHBvcnQgY29uc3QgYnV0dG9uVXBkYXRlQXZhdGFyID0gcHJvZmlsZS5xdWVyeVNlbGVjdG9yKFxuICBcIi5wcm9maWxlX19hdmF0YXItZWRpdFwiXG4pO1xuLy8gcHJvZmlsZSAoaW5mbykgZm9ybSAmIGlucHV0IHZhcnNcbmV4cG9ydCBjb25zdCBtb2RhbFdpbmRvd1Byb2ZpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsX3Byb2ZpbGVfaW5mb1wiKTtcbmNvbnN0IGZvcm1Qcm9maWxlID0gZG9jdW1lbnQuZm9ybXNbXCJwcm9maWxlX2luZm9fZm9ybVwiXTtcbmV4cG9ydCBjb25zdCBpbnB1dFByb2ZpbGVOYW1lID0gZm9ybVByb2ZpbGVbXCJuYW1lXCJdOyAvLyBjYW4gcmVmZXIgdG8gYnkgbmFtZSBvciBpZCBhdHRyaWJzXG5leHBvcnQgY29uc3QgaW5wdXRQcm9maWxlRGVzY3JpcHRpb24gPSBmb3JtUHJvZmlsZVtcImRlc2NyaXB0aW9uXCJdO1xuLy8gcHJvZmlsZSBhdmF0YXIgZnJvbSAmIGlucHV0IHZhclxuZXhwb3J0IGNvbnN0IHN1Ym1pdFByb2ZpbGVJbmZvID0gZm9ybVByb2ZpbGVbXCJwcm9maWxlX2luZm9fZm9ybV9zYXZlXCJdO1xuZXhwb3J0IGNvbnN0IG1vZGFsV2luZG93UHJvZmlsZUF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI21vZGFsX3Byb2ZpbGVfYXZhdGFyXCJcbik7XG5jb25zdCBmb3JtUHJvZmlsZUF2YXRhciA9IGRvY3VtZW50LmZvcm1zW1wicHJvZmlsZV9hdmF0YXJfZm9ybVwiXTtcbmV4cG9ydCBjb25zdCBpbnB1dFByb2ZpbGVBdmF0YXIgPSBmb3JtUHJvZmlsZUF2YXRhcltcImF2YXRhclwiXTtcbmV4cG9ydCBjb25zdCBzdWJtaXRQcm9maWxlQXZhdGFyID1cbiAgZm9ybVByb2ZpbGVBdmF0YXJbXCJwcm9maWxlX2F2YXRhcl9mb3JtX3NhdmVcIl07XG5cbi8vIGluaXQgY2FyZCBhZGQgJiByZWxhdGVkIG1vZGFsIHdpbmRvd1xuZXhwb3J0IGNvbnN0IGJ1dHRvbkFkZENhcmQgPSBwcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcbmV4cG9ydCBjb25zdCBtb2RhbFdpbmRvd0NhcmRBZGQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsX2NhcmQtYWRkXCIpO1xuLy8gY2FyZC1hZGQgZm9ybSAmIGlucHV0IHZhcnNcbmV4cG9ydCBjb25zdCBmb3JtQ2FyZEFkZCA9IGRvY3VtZW50LmZvcm1zW1wiY2FyZC1hZGRfZm9ybVwiXTtcbmV4cG9ydCBjb25zdCBzdWJtaXRDYXJkQWRkID0gZm9ybUNhcmRBZGRbXCJjYXJkLWFkZF9mb3JtX3NhdmVcIl07XG5cbi8vIGluaXQgY2FyZCB2aWV3IG1vZGFsIHdpbmRvd1xuZXhwb3J0IGNvbnN0IG1vZGFsV2luZG93Q2FyZFZpZXcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsX2NhcmQtdmlld1wiKTtcbmV4cG9ydCBjb25zdCBtb2RhbEltYWdlID0gbW9kYWxXaW5kb3dDYXJkVmlldy5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZVwiKTtcbmV4cG9ydCBjb25zdCBtb2RhbENhcHRpb24gPVxuICBtb2RhbFdpbmRvd0NhcmRWaWV3LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NhcHRpb25cIik7XG4vLyBzaW5jZSB0aGVzZSBhcmUgc2luZ3VsYXIgZWxlbWVudHMgdGhhdCB3b3VsZCBjaGFuZ2UgY29udGVudCBmb3IgbWFueSBpbWFnZXMvY2FwdGlvbnMsIHFTIHNob3VsZCBvbmx5IGJlIHVzZWQgb25jZSBoZXJlXG5cbi8vIGluaXQgY2FyZCBkZWxldGUgbW9kYWwgd2luZG93XG5leHBvcnQgY29uc3QgbW9kYWxXaW5kb3dDYXJkRGVsZXRlID1cbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbF9jYXJkLWRlbGV0ZVwiKTtcblxuLy8gaW5pdCB0aGUgZ2FsbGVyeSBjYXJkcyBhbmQgYnVpbGQgYWxsIGRlcml2YXRpdmUgYWN0aW9ucyB1cG9uIHBhZ2UgbG9hZFxuZXhwb3J0IGNvbnN0IGNhcmRzR2FsbGVyeSA9IFwiLmdhbGxlcnlfX2NhcmRzXCI7XG5cbi8qIGNvbnN0YW50IGV4cG9ydGluZyBub3RlOlxuICB1c3VhbGx5IHRob3NlIHRoYXQgd291bGQgYmUgcmVmZXJlbmNlZCBpbiBjb2RlIG1vcmUgdGhhbiBvbmNlIHNob3VsZCBiZSBsaXN0ZWQgZnJvbSBoZXJlLlxuICBzZWxlY3RvcnMgIT0gZWxlbWVudHM7IHNlbGVjdG9ycyBhcmUgc3RyaW5ncyBhbmQgZG9uJ3QgbmVlZCB0byBiZSBsaXN0ZWQgaGVyZSAtIGVsZW1zIGRvLlxuKi9cbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBQb3B1cFdpdGhDb25maXJtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm0uanNcIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuLyogREVDTEFSQVRJVkUgU0VDVElPTiAqL1xuaW1wb3J0IHtcbiAgY29uZmlndXJhdGlvbixcbiAgYnV0dG9uRWRpdFByb2ZpbGUsXG4gIHByb2ZpbGVOYW1lLFxuICBwcm9maWxlRGVzY3JpcHRpb24sXG4gIGJ1dHRvblVwZGF0ZUF2YXRhcixcbiAgcHJvZmlsZUF2YXRhcixcbiAgbW9kYWxXaW5kb3dQcm9maWxlLFxuICBpbnB1dFByb2ZpbGVOYW1lLFxuICBpbnB1dFByb2ZpbGVEZXNjcmlwdGlvbixcbiAgYnV0dG9uQWRkQ2FyZCxcbiAgbW9kYWxXaW5kb3dDYXJkQWRkLFxuICBmb3JtQ2FyZEFkZCxcbiAgbW9kYWxXaW5kb3dDYXJkVmlldyxcbiAgbW9kYWxJbWFnZSxcbiAgbW9kYWxDYXB0aW9uLFxuICBtb2RhbFdpbmRvd0NhcmREZWxldGUsXG4gIG1vZGFsV2luZG93UHJvZmlsZUF2YXRhcixcbiAgaW5wdXRQcm9maWxlQXZhdGFyLFxuICBjYXJkc0dhbGxlcnksXG4gIHN1Ym1pdFByb2ZpbGVJbmZvLFxuICBzdWJtaXRQcm9maWxlQXZhdGFyLFxuICBzdWJtaXRDYXJkQWRkLFxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xuXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxuICBoZWFkZXJzOiB7XG4gICAgXCJjb250ZW50LXR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgYXV0aG9yaXphdGlvbjogXCJjNDg1NjRmMy1lY2ZiLTRhNjUtYjM1ZC0wMzFhYWJjODQyY2VcIixcbiAgfSxcbn0pO1xuXG5sZXQgY2FyZFNlY3Rpb247IC8vIHNpbmNlIHRoZSBjYXJkIHNlY3Rpb24gaXMgYmVpbmcgdGllZCB0byB0aGUgRE9NIGFuZCBpcyBuZWVkZWQgdG8gYm90aCBpbml0IGFuZCBhZGQgY2FyZHMgbGF0ZXIgb24sIGl0IHdvdWxkIG5lZWQgdG8gYmUgZGVjbGFyZWQgYXQgdGhlIGdsb2JhbCBzY29wZSBhbmQgY2FuIGJlIHJlYXNzaWduZWQgd2l0aCBsZXQuXG5sZXQgdXNlcklkO1xuXG5hcGlcbiAgLmdldFVzZXJBbmRDYXJkcyhbXG4gICAgLy8gdGhpcyBpcyBhIFByb21pc2UgYXJyYXkgdGhhdCB3b3VsZCBnZXQgZnVsZmlsbGVkIHdoZW4gYWxsIHN1YnNlcXVlbnQgcHJvbWlzZXMgYXJlIGZ1bGZpbGxlZCB0b28gKCYmLXN0eWxlKVxuICAgIGFwaVxuICAgICAgLmdldFVzZXJQcm9maWxlRGF0YSgpIC8vIHJldHVybiB1c2VyIGZyb20gc2VydmVyIGFzIGEgSlNPTiBvYmplY3RcbiAgICAgIC50aGVuKCh7IF9pZCwgbmFtZSwgYWJvdXQsIGF2YXRhciB9KSA9PiB7XG4gICAgICAgIHVzZXJJZCA9IF9pZDsgLy8gZm9yIGZ1dHVyZSB1c2VcbiAgICAgICAgdXNlclByb2ZpbGUuc2V0VXNlckluZm8obmFtZSwgYWJvdXQpOyAvLyBkZXNwaXRlIGJlaW5nIGFzeW5jLCB0aGlzIHdpbGwgYWxyZWFkeSBiZSBpbml0aWFsaXplZCB0aGFua3MgdG8gZXZlbnQgbG9vcCAoc3luYyB0aGVuIGFzeW5jKVxuICAgICAgICB1c2VyUHJvZmlsZS5zZXRBdmF0YXIoYXZhdGFyKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7IC8vIHcvb3V0IGEgd2F5IHRvIHJldHVybiBvciBwcmludCBlcnJvciB0byBjb25zb2xlIGl0IGdldHMgdW5jYXVnaHRcbiAgICAgIH0pLFxuICAgIGFwaVxuICAgICAgLmdldEluaXRpYWxDYXJkcygpIC8vIHJldHVybiB0aGUgY2FyZCBhcnJheSBmcm9tIHRoZSBzZXJ2ZXJcbiAgICAgIC50aGVuKChjYXJkQXJyYXkpID0+IHtcbiAgICAgICAgLy8gYmVjYXVzZSB0aGUgc2VjdGlvbiB2YXIgaGFzIHRvIGJlIGFjY2Vzc2VkIGluIHRoZSBhc3luYyBidWJibGUsIGV4cG9ydGluZyBpdCB3b3VsZCBiZSBhIHNsaWdodCBtb3JlIGNvbXBsaWNhdGVkIHdoZW4gbmV3IGNhcmRzIGhhdmUgdG8gYmUgYWRkZWQgdG8gdGhlIHNlcnZlciwgbm90IGp1c3QgZnJvbSBpdFxuICAgICAgICBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGl0ZW1zOiBjYXJkQXJyYXksXG4gICAgICAgICAgICByZW5kZXJlcjogKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKGl0ZW0pO1xuICAgICAgICAgICAgICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgICBjYXJkc0dhbGxlcnlcbiAgICAgICAgKTtcbiAgICAgICAgY2FyZFNlY3Rpb24ucmVuZGVySXRlbXMoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB9KSxcbiAgXSlcbiAgLmNhdGNoKChlcnIpID0+IHtcbiAgICBjb25zb2xlLmVycm9yKGVycik7XG4gIH0pO1xuXG5jb25zdCBjcmVhdGVDYXJkID0gKGNhcmRJdGVtKSA9PiB7XG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcbiAgICBjYXJkSXRlbSxcbiAgICBcIiNjYXJkLXRlbXBsYXRlXCIsXG4gICAgaGFuZGxlQ2FyZFBvcHVwSW1hZ2UsXG4gICAgaGFuZGxlQ2FyZFBvcHVwRGVsZXRlLFxuICAgIGhhbmRsZUNhcmRMaWtlXG4gICk7XG4gIHJldHVybiBjYXJkLmdlbmVyYXRlQ2FyZCgpO1xufTtcblxuY29uc3QgZm9ybVZhbGlkYXRvcnMgPSB7fTtcbkFycmF5LmZyb20oZG9jdW1lbnQuZm9ybXMpLmZvckVhY2goKGZvcm1FbGVtZW50KSA9PiB7XG4gIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZ3VyYXRpb24sIGZvcm1FbGVtZW50KTtcbiAgZm9ybVZhbGlkYXRvcnNbZm9ybUVsZW1lbnQuaWRdID0gdmFsaWRhdG9yO1xuICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xufSk7XG4vKiBFTkQgREVDTEFSQVRJVkUgU0VDVElPTiAqL1xuXG4vKiBQUk9GSUxFIElORk8gU0VDVElPTiAqL1xuY29uc3QgdXNlclByb2ZpbGUgPSBuZXcgVXNlckluZm8oe1xuICAvLyBwYXNzIGFzIGFyZ3VtZW50cyB0aGUgSFRNTCBET00gcHJvZmlsZSBlbGVtZW50c1xuICBuYW1lOiBwcm9maWxlTmFtZSxcbiAgZGVzY3JpcHRpb246IHByb2ZpbGVEZXNjcmlwdGlvbixcbiAgYXZhdGFyOiBwcm9maWxlQXZhdGFyLFxufSk7XG5cbmJ1dHRvbkVkaXRQcm9maWxlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNvbnN0IHsgbmFtZSwgZGVzY3JpcHRpb24gfSA9IHVzZXJQcm9maWxlLmdldFVzZXJJbmZvKCk7XG4gIGlucHV0UHJvZmlsZU5hbWUudmFsdWUgPSBuYW1lO1xuICBpbnB1dFByb2ZpbGVEZXNjcmlwdGlvbi52YWx1ZSA9IGRlc2NyaXB0aW9uO1xuICBmb3JtVmFsaWRhdG9yc1tcInByb2ZpbGVfaW5mb19mb3JtXCJdLnJlc2V0Rm9ybVZhbGlkYXRpb24oKTsgLy8gaW5wdXQgYWx3YXlzIHZhbGlkIHdoZW4gdGFraW5nIGZyb20gdGhlIGh0bWwgcGFnZVxuICBwb3B1cFByb2ZpbGVJbmZvLm9wZW4oKTtcbn0pO1xuXG5jb25zdCBwb3B1cFByb2ZpbGVJbmZvID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIG1vZGFsV2luZG93UHJvZmlsZSxcbiAgKGV2ZW50LCB7IG5hbWUsIGRlc2NyaXB0aW9uIH0pID0+IHtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIHBvcHVwUHJvZmlsZUluZm8uc2V0UmVuZGVyKHRydWUpOyAvLyByZW5kZXJzIGZhc3RlciB3aGVuIHN5bmNlZCBiZWZvcmUgdGhlIGFzeW5jIGJlZ2luc1xuICAgIGFwaVxuICAgICAgLnNldFVzZXJQcm9maWxlRGF0YShuYW1lLCBkZXNjcmlwdGlvbilcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgdXNlclByb2ZpbGUuc2V0VXNlckluZm8obmFtZSwgZGVzY3JpcHRpb24pO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgIH0pXG4gICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgIHBvcHVwUHJvZmlsZUluZm8uY2xvc2UoKTtcbiAgICAgICAgcG9wdXBQcm9maWxlSW5mby5zZXRSZW5kZXIoZmFsc2UpO1xuICAgICAgfSk7XG4gIH0sXG4gIGNvbmZpZ3VyYXRpb24uaW5wdXRTZWxlY3RvcixcbiAgc3VibWl0UHJvZmlsZUluZm8sXG4gIFwiU2F2aW5nLi4uXCJcbik7XG5wb3B1cFByb2ZpbGVJbmZvLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4vKiBFTkQgUFJPRklMRSBJTkZPIFNFQ1RJT04gKi9cblxuLyogUFJPRklMRSBBVkFUQVIgU0VDVElPTiAqL1xuYnV0dG9uVXBkYXRlQXZhdGFyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGlucHV0UHJvZmlsZUF2YXRhci52YWx1ZSA9IHByb2ZpbGVBdmF0YXIuc3JjO1xuICBwb3B1cFByb2ZpbGVBdmF0YXIub3BlbigpO1xufSk7XG5jb25zdCBwb3B1cFByb2ZpbGVBdmF0YXIgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgbW9kYWxXaW5kb3dQcm9maWxlQXZhdGFyLFxuICAoZXZlbnQsIHsgYXZhdGFyIH0pID0+IHtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIHBvcHVwUHJvZmlsZUF2YXRhci5zZXRSZW5kZXIodHJ1ZSk7XG4gICAgYXBpXG4gICAgICAuc2V0VXNlclByb2ZpbGVBdmF0YXIoYXZhdGFyKVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICBwcm9maWxlQXZhdGFyLnNyYyA9IGF2YXRhcjtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB9KVxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICBwb3B1cFByb2ZpbGVBdmF0YXIuY2xvc2UoKTtcbiAgICAgICAgcG9wdXBQcm9maWxlQXZhdGFyLnNldFJlbmRlcihmYWxzZSk7XG4gICAgICB9KTtcbiAgfSxcbiAgY29uZmlndXJhdGlvbi5pbnB1dFNlbGVjdG9yLFxuICBzdWJtaXRQcm9maWxlQXZhdGFyLFxuICBcIlNhdmluZy4uLlwiXG4pO1xucG9wdXBQcm9maWxlQXZhdGFyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4vKiBFTkQgUFJPRklMRSBBVkFUQVIgU0VDVElPTiAqL1xuXG4vKiBDQVJEIEFERCBTRUNUSU9OICovXG5idXR0b25BZGRDYXJkLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIC8vIGRvbid0IHNob3cgZXJyb3JzIHVwb24gb3BlbmluZyB0aGUgbW9kYWwgd2hlbiBubyBpbnB1dCBpcyBpc3N1ZWRcbiAgcG9wdXBDYXJkQWRkLm9wZW4oKTtcbn0pO1xuXG5jb25zdCBwb3B1cENhcmRBZGQgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgbW9kYWxXaW5kb3dDYXJkQWRkLFxuICAoZXZlbnQsIHsgdGl0bGUsIGxpbmsgfSkgPT4ge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgcG9wdXBDYXJkQWRkLnNldFJlbmRlcih0cnVlKTtcbiAgICBhcGlcbiAgICAgIC5hZGROZXdDYXJkKHRpdGxlLCBsaW5rKVxuICAgICAgLnRoZW4oKG5ld0NhcmQpID0+IHtcbiAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKG5ld0NhcmQpO1xuICAgICAgICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50LCBcInByZXBlbmRcIik7IC8vIGNhbiBzdGlsbCBiZSB1c2VkIHRvIGFkZCBsYXRlciBjYXJkcywgbm90IGp1c3QgaW5pdCBvbmVzXG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgfSlcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgcG9wdXBDYXJkQWRkLmNsb3NlKCk7XG4gICAgICAgIHBvcHVwQ2FyZEFkZC5zZXRSZW5kZXIoZmFsc2UpO1xuICAgICAgICBmb3JtQ2FyZEFkZC5yZXNldCgpO1xuICAgICAgICBmb3JtVmFsaWRhdG9yc1tcImNhcmQtYWRkX2Zvcm1cIl0uZGlzYWJsZUJ1dHRvbigpO1xuICAgICAgfSk7XG4gIH0sXG4gIGNvbmZpZ3VyYXRpb24uaW5wdXRTZWxlY3RvcixcbiAgc3VibWl0Q2FyZEFkZCxcbiAgXCJDcmVhdGluZy4uLlwiXG4pO1xucG9wdXBDYXJkQWRkLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4vKiBFTkQgQ0FSRCBBREQgU0VDVElPTiAqL1xuXG4vKiBDQVJEIFZJRVcgSU1BR0UgU0VDVElPTiAqL1xuZnVuY3Rpb24gaGFuZGxlQ2FyZFBvcHVwSW1hZ2UoY2FyZCkge1xuICAvLyBzdWdnZXN0ZWQgYnkgU3ByaW50IDcgcHJvamVjdCB0byBrZWVwIHRoaXMgZnVuYyBpbiBpbmRleC5qcyBmb3Igbm93XG4gIHBvcHVwSW1hZ2Uub3BlbihjYXJkKTsgLy8gc2luY2UgXCJ0aGlzXCIgaXMgcHJvaGliaXRlZCBvdXRzaWRlIG9mIGNsYXNzZXMsIGFuZCBwYXNzaW5nIGFuIGFyZyB0byB0aGUgZnVuYyBhcyBhIHBhcmFtIHRvIHRoaXMgZnVuYyBjYXVzZXMgYSBsZXhpY2FsIHJlZiBlcnIsIHRoZW4gaW4gdGhlIGNsYXNzJ3MgaGFuZGxlciBmdW5jIGl0IHdvdWxkIG5lZWQgdG8gcGFzcyB0aGUgcmVhZHktbWFkZSBnZXRJbmZvKCkgbWV0aG9kIHRvIHBhc3MgdGhyb3VnaCB1bmltcGVkZWRcbn1cbmNvbnN0IHBvcHVwSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2UobW9kYWxXaW5kb3dDYXJkVmlldywge1xuICBpbWFnZTogbW9kYWxJbWFnZSxcbiAgY2FwdGlvbjogbW9kYWxDYXB0aW9uLFxufSk7XG5wb3B1cEltYWdlLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4vKiBFTkQgQ0FSRCBWSUVXIElNQUdFIFNFQ1RJT04gKi9cblxuLyogQ0FSRCBMSUtFL1VOTElLRSBTRUNUSU9OICovXG5mdW5jdGlvbiBoYW5kbGVDYXJkTGlrZShjYXJkKSB7XG4gIGNvbnN0IHJlcXVlc3QgPSBjYXJkLmdldEluZm8oKS5pc0xpa2VkID8gXCJ1bmxpa2VDYXJkXCIgOiBcImxpa2VDYXJkXCI7IC8vIGludmVydGVkIGxvZ2ljIGdldHMgaGFuZGxlZCBoZXJlXG4gIGFwaVtyZXF1ZXN0XShjYXJkLmdldEluZm8oKS5pZClcbiAgICAudGhlbigoY2FyZFJlcykgPT4ge1xuICAgICAgY2FyZC5saWtlQ2FyZChjYXJkUmVzLmlzTGlrZWQpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICB9KTtcbn1cbi8qIEVORCBDQVJEIExJS0UvVU5MSUtFIFNFQ1RJT04gKi9cblxuLyogQ0FSRCBERUxFVEUgU0VDVElPTiAqL1xuZnVuY3Rpb24gaGFuZGxlQ2FyZFBvcHVwRGVsZXRlKGNhcmQpIHtcbiAgcG9wdXBDYXJkRGVsZXRlLm9wZW4oY2FyZCk7XG59XG5jb25zdCBwb3B1cENhcmREZWxldGUgPSBuZXcgUG9wdXBXaXRoQ29uZmlybShcbiAgbW9kYWxXaW5kb3dDYXJkRGVsZXRlLFxuICAoZXZlbnQsIGNhcmQpID0+IHtcbiAgICAvLyB0aGlzIHN1YmNsYXNzIGFjdHMgbGlrZSB0aGUgZm9ybSBwb3B1cCBzdWJjbGFzcyBleGNlcHQgaXQgaGFzIG5vIGlucHV0cy4gSXQgZG9lcyBob3dldmVyIGhlbHAgdG8gcGFzcyB0aGUgbmVjZXNzYXJ5IHBhcmFtIHRvIGhhbmRsZSBjYXJkIGRlbGV0aW9uXG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAvLyBjb25zb2xlLmxvZyhjYXJkLl9jYXJkRWxlbWVudCk7XG4gICAgYXBpXG4gICAgICAuZGVsZXRlQ2FyZChjYXJkLmdldEluZm8oKS5pZClcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgY2FyZC5kZWxldGVDYXJkKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgfSlcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgcG9wdXBDYXJkRGVsZXRlLmNsb3NlKCk7XG4gICAgICB9KTtcbiAgfVxuKTtcbnBvcHVwQ2FyZERlbGV0ZS5zZXRFdmVudExpc3RlbmVycygpO1xuLyogRU5EIENBUkQgREVMRVRFIFNFQ1RJT04gKi9cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICB0aGlzLl9iYXNlVXJsID0gb3B0aW9ucy5iYXNlVXJsO1xuICAgIHRoaXMuX2hlYWRlcnMgPSBvcHRpb25zLmhlYWRlcnM7XG4gIH1cblxuICBnZXRVc2VyUHJvZmlsZURhdGEoKSB7XG4gICAgLy8gcmV0dXJucyBhIFByb21pc2UgdHlwZSBvYmplY3Qgd2hpY2ggaXMgXCJ0aGVuYWJsZVwiIHRvIGNvbnRpbnVlIHRoZSBhc3luYyBjaGFpbiB0byBnbyBmb3J3YXJkIG9uY2UgdGhlIEpTT04gb2JqZWN0IGlzIHJldHJpZXZlZCBmcm9tIHRoZSBzZXJ2ZXIgdmlhIHRoZSBBUEkgY2FsbFxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSlcbiAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgaWYgKHJlcy5vaykgcmV0dXJuIHJlcy5qc29uKCk7IC8vIGlmIHN1Y2Nlc3NmdWwsIHJldHVybnMgYSB1c2VyIG9iamVjdFxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYGVycm9yICR7cmVzLnN0YXR1c30gd2hpbGUgZ2V0dGluZyB1c2VyIGRhdGFgKTsgLy8gb3RoZXJ3aXNlLCBvdXRwdXQgYW4gZXJyb3IgdG8gLmNhdGNoXG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycik7IC8vIHByb3Blcmx5IHJldHVybiBhIHJlamVjdGVkIFByb21pc2Ugc3RhdGVcbiAgICAgIH0pO1xuICB9XG5cbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSlcbiAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgaWYgKHJlcy5vaykgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgZXJyb3IgJHtyZXMuc3RhdHVzfSB3aGlsZSBnZXR0aW5nIGNhcmRzIGRhdGFgKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgZ2V0VXNlckFuZENhcmRzKHByb21pc2VBcnJheSkge1xuICAgIHJldHVybiBQcm9taXNlLmFsbChwcm9taXNlQXJyYXkpLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChcIlNvbWV0aGluZyB3ZW50IHdyb25nIDooXCIsIGVycik7XG4gICAgfSk7XG4gIH1cblxuICBzZXRVc2VyUHJvZmlsZURhdGEobmFtZSwgZGVzY3JpcHRpb24pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IG5hbWU6IG5hbWUsIGFib3V0OiBkZXNjcmlwdGlvbiB9KSxcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICBpZiAocmVzLm9rKSByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBlcnJvciAke3Jlcy5zdGF0dXN9IHdoaWxlIHVwZGF0aW5nIHVzZXIgZGF0YWApO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnIpO1xuICAgICAgfSk7XG4gIH1cblxuICBhZGROZXdDYXJkKHRpdGxlLCBsaW5rKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IG5hbWU6IHRpdGxlLCBsaW5rOiBsaW5rIH0pLFxuICAgIH0pXG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGlmIChyZXMub2spIHJldHVybiByZXMuanNvbigpO1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYGVycm9yICR7cmVzLnN0YXR1c30gd2hpbGUgYWRkaW5nIGEgbmV3IGNhcmRgKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgZGVsZXRlQ2FyZChpZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2lkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSlcbiAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgaWYgKHJlcy5vaykgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgZXJyb3IgJHtyZXMuc3RhdHVzfSB3aGlsZSBkZWxldGluZyBhIGNhcmRgKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgbGlrZUNhcmQoaWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiUFVUXCIsIC8vIGRlc3BpdGUgYmVpbmcgXCJQVVRcIiwgdGhlIHNlcnZlciBoYW5kbGVzIHRoZSBib29sZWFuIGp1c3QgZmluZSB3L291dCBhIGJvZHkgaW5zaWRlIHRoZSByZXF1ZXN0XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pXG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGlmIChyZXMub2spIHJldHVybiByZXMuanNvbigpO1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYGVycm9yICR7cmVzLnN0YXR1c30gd2hpbGUgbGlraW5nIGEgY2FyZGApO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnIpO1xuICAgICAgfSk7XG4gIH1cblxuICB1bmxpa2VDYXJkKGlkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICBpZiAocmVzLm9rKSByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBlcnJvciAke3Jlcy5zdGF0dXN9IHdoaWxlIHVubGlraW5nIGEgY2FyZGApO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnIpO1xuICAgICAgfSk7XG4gIH1cblxuICBzZXRVc2VyUHJvZmlsZUF2YXRhcihhdmF0YXIpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBhdmF0YXI6IGF2YXRhciB9KSxcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICBpZiAocmVzLm9rKSByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBlcnJvciAke3Jlcy5zdGF0dXN9IHdoaWxlIHVwZGF0aW5nIGFuIGF2YXRhcmApO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnIpO1xuICAgICAgfSk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IoeyBuYW1lLCBkZXNjcmlwdGlvbiwgYXZhdGFyIH0pIHtcbiAgICB0aGlzLl9uYW1lRWxlbWVudCA9IG5hbWU7XG4gICAgdGhpcy5fam9iRWxlbWVudCA9IGRlc2NyaXB0aW9uO1xuICAgIHRoaXMuX2F2YXRhckVsZW1lbnQgPSBhdmF0YXI7XG4gIH1cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50LFxuICAgICAgZGVzY3JpcHRpb246IHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgfTtcbiAgfVxuXG4gIHNldFVzZXJJbmZvKG5hbWUsIGRlc2NyaXB0aW9uKSB7XG4gICAgdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQgPSBkZXNjcmlwdGlvbjtcbiAgfVxuXG4gIGdldEF2YXRhcigpIHtcbiAgICByZXR1cm4gdGhpcy5fYXZhdGFyRWxlbWVudC5zcmM7XG4gIH1cblxuICBzZXRBdmF0YXIoYXZhdGFyKSB7XG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudC5zcmMgPSBhdmF0YXI7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXAsIG1vZGFsRWxlbWVudHMpIHtcbiAgICBzdXBlcihwb3B1cCk7IC8vIHBvcHVwIHNlbGVjdGVkIGVsZW1lbnRcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnRzID0gbW9kYWxFbGVtZW50czsgLy8gY2FsbGJhY2sgZm9yIHRoZSBtb2RhbCdzIGVsZW1lbnRzXG4gIH1cblxuICAvLyBzZXRFdmVudExpc3RlbmVycygpIGRvZXNuJ3QgbmVlZCBzdXBlciBiZWNhdXNlIGl0J3Mgd29ya2luZyBpbiBhIGRlZmF1bHQgYmVoYXZpb3JcblxuICBvcGVuKHsgbmFtZSwgbGluayB9KSB7XG4gICAgdGhpcy5fbW9kYWxFbGVtZW50cy5pbWFnZS5zcmMgPSBsaW5rO1xuICAgIHRoaXMuX21vZGFsRWxlbWVudHMuaW1hZ2UuYWx0ID0gbmFtZTtcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnRzLmNhcHRpb24udGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxuXG4gIC8vIGNsb3NlKCkgZG9lc24ndCBuZWVkIG1ldGhvZCBvdmVycmlkaW5nIGVpdGhlclxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aENvbmZpcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwLCBoYW5kbGVTdWJtaXQpIHtcbiAgICBzdXBlcihwb3B1cCk7XG4gICAgdGhpcy5faGFuZGxlU3VibWl0ID0gaGFuZGxlU3VibWl0O1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldmVudCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlU3VibWl0KGV2ZW50LCB0aGlzLl9pbml0aWF0b3IpOyAvLyBjb250aW51ZWQgZnJvbSB0aGUgb3Blbihpbml0aWF0b3IpIG1ldGhvZFxuICAgIH0pO1xuICB9XG5cbiAgb3Blbihpbml0aWF0b3IpIHtcbiAgICB0aGlzLl9pbml0aWF0b3IgPSBpbml0aWF0b3I7IC8vIHBhc3MgaW5mbyBhYm91dCB3aGF0IHRyaWdnZXJlZCB0aGUgcG9wdXAgdG8gb3BlblxuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIlNlY3Rpb24iLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJzZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJ0aGlzIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX3NlbGVjdG9yIiwicmVuZGVySXRlbXMiLCJfY29udGFpbmVyIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiZm9yRWFjaCIsIml0ZW0iLCJhZGRJdGVtIiwiZWxlbWVudCIsIm1ldGhvZCIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsIkNhcmQiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwiaGFuZGxlQ2FyZERlbGV0ZSIsImhhbmRsZUNhcmRMaWtlIiwibmFtZSIsImxpbmsiLCJfaWQiLCJpc0xpa2VkIiwiX25hbWUiLCJfbGluayIsIl9pc0xpa2VkIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZUNhcmREZWxldGUiLCJfaGFuZGxlQ2FyZExpa2UiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfY2FyZEltYWdlIiwiYWRkRXZlbnRMaXN0ZW5lciIsImdldEluZm8iLCJfY2FyZExpa2UiLCJfY2FyZERlbGV0ZSIsImxpa2VDYXJkIiwiY2xhc3NMaXN0IiwiZGVsZXRlQ2FyZCIsImNsb3Nlc3QiLCJyZW1vdmUiLCJfY2FyZEVsZW1lbnQiLCJfZ2V0VGVtcGxhdGUiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiZ2VuZXJhdGVDYXJkIiwic3JjIiwiYWx0IiwidGV4dENvbnRlbnQiLCJpZCIsIkZvcm1WYWxpZGF0b3IiLCJjb25maWciLCJmb3JtIiwiX2NvbmZpZyIsIl9mb3JtIiwiX2lucHV0TGlzdCIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbnB1dEVsZW1lbnQiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiX2J1dHRvbkVsZW1lbnQiLCJvYmoiLCJfaGFzSW52YWxpZElucHV0IiwiX3Nob3dJbnB1dEVycm9yIiwiZGlzYWJsZUJ1dHRvbiIsIl9oaWRlSW5wdXRFcnJvciIsImVuYWJsZUJ1dHRvbiIsImlucHV0TGlzdCIsInNvbWUiLCJ2YWxpZGl0eSIsInZhbGlkIiwiaW5wdXRFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIiwiYWRkIiwicmVwbGFjZSIsInNldEF0dHJpYnV0ZSIsInJlbW92ZUF0dHJpYnV0ZSIsInJlc2V0Rm9ybVZhbGlkYXRpb24iLCJlbmFibGVWYWxpZGF0aW9uIiwiUG9wdXAiLCJwb3B1cCIsIl9wb3B1cCIsInNldEV2ZW50TGlzdGVuZXJzIiwiZXZlbnQiLCJ0YXJnZXQiLCJjbG9zZSIsIm9wZW4iLCJfZXNjQ2FsbGJhY2siLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImtleSIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVTdWJtaXQiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0U2VsZWN0b3IiLCJzdWJtaXRUZXh0Iiwic3VwZXIiLCJfaGFuZGxlU3VibWl0IiwiX2lucHV0U2VsZWN0b3IiLCJfc3VibWl0U2VsZWN0b3IiLCJfc3VibWl0VGV4dCIsIl9zdWJtaXRPcmlnaW5hbCIsIl9nZXRJbnB1dFZhbHVlcyIsIl9pbnB1dEZpZWxkcyIsImlucHV0VmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsInNldFJlbmRlciIsInN0YXRlIiwiY29uZmlndXJhdGlvbiIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImFjdGl2ZUJ1dHRvbkNsYXNzIiwiYWN0aXZlRXJyb3JDbGFzcyIsInByb2ZpbGUiLCJidXR0b25FZGl0UHJvZmlsZSIsInByb2ZpbGVOYW1lIiwicHJvZmlsZURlc2NyaXB0aW9uIiwicHJvZmlsZUF2YXRhciIsImJ1dHRvblVwZGF0ZUF2YXRhciIsIm1vZGFsV2luZG93UHJvZmlsZSIsImZvcm1Qcm9maWxlIiwiZm9ybXMiLCJpbnB1dFByb2ZpbGVOYW1lIiwiaW5wdXRQcm9maWxlRGVzY3JpcHRpb24iLCJzdWJtaXRQcm9maWxlSW5mbyIsIm1vZGFsV2luZG93UHJvZmlsZUF2YXRhciIsImZvcm1Qcm9maWxlQXZhdGFyIiwiaW5wdXRQcm9maWxlQXZhdGFyIiwic3VibWl0UHJvZmlsZUF2YXRhciIsImJ1dHRvbkFkZENhcmQiLCJtb2RhbFdpbmRvd0NhcmRBZGQiLCJmb3JtQ2FyZEFkZCIsInN1Ym1pdENhcmRBZGQiLCJtb2RhbFdpbmRvd0NhcmRWaWV3IiwibW9kYWxJbWFnZSIsIm1vZGFsQ2FwdGlvbiIsIm1vZGFsV2luZG93Q2FyZERlbGV0ZSIsImFwaSIsIm9wdGlvbnMiLCJfYmFzZVVybCIsImJhc2VVcmwiLCJfaGVhZGVycyIsImhlYWRlcnMiLCJnZXRVc2VyUHJvZmlsZURhdGEiLCJmZXRjaCIsInRoZW4iLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiY2F0Y2giLCJlcnIiLCJnZXRJbml0aWFsQ2FyZHMiLCJnZXRVc2VyQW5kQ2FyZHMiLCJwcm9taXNlQXJyYXkiLCJhbGwiLCJzZXRVc2VyUHJvZmlsZURhdGEiLCJkZXNjcmlwdGlvbiIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWJvdXQiLCJhZGROZXdDYXJkIiwidGl0bGUiLCJ1bmxpa2VDYXJkIiwic2V0VXNlclByb2ZpbGVBdmF0YXIiLCJhdmF0YXIiLCJhdXRob3JpemF0aW9uIiwiY2FyZFNlY3Rpb24iLCJ1c2VySWQiLCJ1c2VyUHJvZmlsZSIsInNldFVzZXJJbmZvIiwic2V0QXZhdGFyIiwiY29uc29sZSIsImVycm9yIiwiY2FyZEFycmF5IiwiY2FyZEVsZW1lbnQiLCJjcmVhdGVDYXJkIiwiY2FyZEl0ZW0iLCJoYW5kbGVDYXJkUG9wdXBJbWFnZSIsImhhbmRsZUNhcmRQb3B1cERlbGV0ZSIsImZvcm1WYWxpZGF0b3JzIiwiZm9ybUVsZW1lbnQiLCJ2YWxpZGF0b3IiLCJfbmFtZUVsZW1lbnQiLCJfam9iRWxlbWVudCIsIl9hdmF0YXJFbGVtZW50IiwiZ2V0VXNlckluZm8iLCJnZXRBdmF0YXIiLCJwb3B1cFByb2ZpbGVJbmZvIiwiX3JlZjIiLCJwcmV2ZW50RGVmYXVsdCIsImZpbmFsbHkiLCJwb3B1cFByb2ZpbGVBdmF0YXIiLCJfcmVmMyIsInBvcHVwQ2FyZEFkZCIsIl9yZWY0IiwibmV3Q2FyZCIsInJlc2V0IiwiY2FyZCIsInBvcHVwSW1hZ2UiLCJtb2RhbEVsZW1lbnRzIiwiX21vZGFsRWxlbWVudHMiLCJpbWFnZSIsImNhcHRpb24iLCJyZXF1ZXN0IiwiY2FyZFJlcyIsInBvcHVwQ2FyZERlbGV0ZSIsIl9pbml0aWF0b3IiLCJpbml0aWF0b3IiXSwic291cmNlUm9vdCI6IiJ9